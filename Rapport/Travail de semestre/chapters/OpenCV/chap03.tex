%
% File: chap01.tex
% Author: Zeller Quentin
% Description: Introduction
%
%\let\textcircled=\pgftextcircled
\chapter{OpenCV \& Flask}
\label{chap:OpenCV}
\section{Introduction}
\label{sec:sec03}
\initial{O}penCV est une librairie multiplate-forme écrite en C/C++ et disponible sur quasiment tout les environnements de développement. Que ce soit les bien connus Linux et Windows mais aussi MacOS ainsi que les systèmes embarqué, RaspberryPI et consorts (ARM) ou les smartphones iOS et Android.\cite{opencv_platforms}. C'est une librairie open source prévue pour le machine learning ainsi que pour le traitement d'image (computer vision)\cite{opencv}. Du fait de sa licence BSD, elle est constamment améliorée par le marché et notamment par les plus grosses entreprises du secteur technologique comme Intel ou Google, ce qui en fait une des librairies leader dans ce domaine. En plus d'être disponible sur la quasi totalité des systèmes d'exploitations elle est également disponible dans multiple langage que sont : C++, C, Python, Java et MATLAB. Nous utiliserons ici la librairie pour Python qui est un langage certes moins optimisé que certains de ses concurrents mais qui à l'instar de Mathlab permet de se concentrer sur le c?ur du sujet. Il dispose en outre d'une bonne communauté et d'un bon support.

Une autre particularité d'OpenCV et ce qui le rend attractif à l'heure actuelle est sa compatibilité avec les processeurs Nvidia et leurs CUDA \footnote{CUDA : Technologie dite GPGPU (General-Purpose Computing on Graphics Processing Units)} Core\cite{opencv_cuda}. Grâce aux avancées des GPUs à l'heure actuelle, principalement due au jeux vidéo mais aussi et principalement au crypto-monnaie les performances sont accrue d'un facteur 30x dans le pire des cas.

OpenCV est la librairie de référence dans le domaine de la "computer vision". Elle comporte plus de 500 fonctions applicable tant a l'imagerie médical, qu'a la robotique ou la sécurité. Elle contient aussi un module de machine-learning complet à usage général\footnote{ML module}.\cite{book_opencv} Cette popularité en fait un élément incontournable en particulier pour des outils d'analyse de vidéo mais des fonctions d'éditions sont possible. Le test suivant en fait preuve.



%=======
\section{Fonctionnement général}
\label{sec:sec03a}
L'exemple suivant démontre qu'il est possible de récupérer un flux vidéo live

\section{Environnement de développement de l'application test}
\label{sec:sec03b}
pycharm opencv, livrairies, flask...

\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\definecolor{mymauve}{rgb}{0.58,0,0.82}
\definecolor{deepred}{rgb}{0.6,0,0}

\lstset{
	language=Python,
	backgroundcolor=\color{white},   % choose the background color
	basicstyle=\footnotesize,        % size of fonts used for the code
	breaklines=true,                 % automatic line breaking only at whitespace
	captionpos=b,                    % sets the caption-position to bottom
	commentstyle=\color{mygreen},    % comment style
	escapeinside={\%*}{*)},          % if you want to add LaTeX within your code
	keywordstyle=\color{blue},       % keyword style
	emphstyle=\ttb\color{deepred},
	stringstyle=\color{mymauve},     % string literal style
}


	\lstinputlisting[language=Python, firstline=7, lastline=37, caption={Live streaming MJPEG with Flask, inspired from Miguel Grinberg. \cite{grinberg}}]{../../app/video_streaming_with_flask_example/main.py}
%	\caption{Live streaming MJPEG with Flask, inspired from Miguel Grinberg. \cite{grinberg}}





\begin{figure}[h]
	\centering
	\frame{\includegraphics[width=0.8\linewidth]{fig01/website}}
	\mycaption[The easy Flask website MJPEG.]{Streaming HTTP avec librairie python Flask}
	\label{fig:flask}
	
\end{figure}

\begin{figure}[h]
	\centering
	\frame{\includegraphics[width=0.8\linewidth]{fig01/example_application}}
	\mycaption[Burn text on live stream, display on GUI]{Intégration texte dans vidéo live, affichage GUI bureau}
	\label{fig:live_text_integration}
	
\end{figure}

\begin{figure}[h]
	\centering
	\frame{\includegraphics[width=1\linewidth]{fig01/flask_simple}}
	\mycaption[The easy Flask website MJPEG. (code)]{Code pour streaming HTTP avec librairie python Flask}
	\label{fig:flask_code}
	
\end{figure}


\section{Environnement de production}
\label{sec:sec03c}
Cette application à été développée en Python sur une environnement linux. Il faut potentiellement faire attention au support de CUDA dont les drivers ne sont pas d'office installé et où l'installation peut être compliquée sur certaines machines trop récente. Les drivers Nvidia ne sont pas forcément bien supporté sur toutes les plateformes linux, Nvidia ne voulant pas développer de l'Open-Source. Si l'on souhaite des drivers open source, regarder les drivers 'nouveau' tout aussi performant que les drivers propriétaire en ce jour.

Compte tenu de tout ces contraintes, l'utilisation du binding OpenCV Python est en faveur de la compatibilité du plus grand nombre. Une autre alternative aurait été Java qui est un langage très propre et académique, en particulier au niveau des structures données qu'il propose. Cependant, Python prend l'avantage dans sa facilité d'implémentation des sources externes grâce a l'implémentation de son fameux outils de gestion de paquet 'pip'. De ce fait les tests on été fait par le biais du language python. Il faut noter aussi que ce langage est très utilisé pour les back-end web. Nous tirons partis de ceci aussi grâce a la librairie Flask.

Intellij - Fedora

camera : windows vs linux 


%=========================================================