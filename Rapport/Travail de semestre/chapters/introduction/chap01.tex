%
% File: chap01.tex
% Author: Zeller Quentin
% Description: Introduction
%
%\let\textcircled=\pgftextcircled
\chapter{Introduction}
\label{chap:Introduction}
\section{Préambule}
\label{sec:preambule}
\initial{C}e travail de recherche consiste en la reconnaissance des différents outils logiciels disponibles sur le marché, permettant l'ajout d'informations en temps réel sur un flux vidéo, dans le but d'apporter aux client-consommateurs des données supplémentaires, notamment lors d'évènements sportifs. Nous utiliserons ici l'exemple du volleyball sans pour autant restreindre les recherches à ce seul but. Cette étude de cas concerne bien évidemment un domaine plus vaste que celui du volleyball ou même des jeux.

L'approche pratique de ce travail explorera aussi les différentes possibilités de collecter les informations statistiques via une interface fortement découplée ce qui permettra l'intégration des données de la manière la plus générique possible.
Cette modularité permettra d'intégrer d'autres sources de données sans repenser l'intégralité de l'application et permettra une plus grande flexibilité quand au sport/jeux auquel elle s'adresse.

Si ce travail s'avère réalisable au regard des contraintes d'un mémoire de Bachelor, il aboutira en l'implémentation d'une solution fonctionnelle. Il est donc nécessaire de recenser toutes les technologies différentes disponibles sur le marché qui serviront comme outils à ce projet. Dans cette introduction sera présenté un tableau recensant toutes les technologies nécessaires à l'implémentation du sujet. Certain de ses outils seront brièvement testés dans les chapitres suivants afin de démontrer leurs difficultés d'implémentation, leurs qualités ainsi que leurs compatibilités. 

De prime abord, il semblerait que deux groupes se distinguent de par les technologies qu'ils emploient. Le groupe télévisuel ordinaire qu'est la "télévision de salon" et un groupe plus orienté ordinateur/téléphone mobile. Nous étudierons s'il est possible de concilier ces deux groupes et choisirons le cas échéant le médium le plus adéquat. Une projection vers le futur est aussi nécessaire, la convergence vers le tout IP ainsi que l'amélioration rapide des Smart-TVs obligent à se projeter vers le futur.


%=======
\section{Cahier des charges de l'application}
\label{sec:sec01}
Le but final de ce travail est de trouver un moyen efficace, fiable et peu couteux de diffuser du contenu audio-visuel à valeur ajoutée et en temps réel. Plus concrètement il s'agit dans le cas d'une retransmission sportive de, premièrement récupérer le/les flux vidéos, les sources de données à incorporer aux flux vidéos, puis de les combiner en un seul service multimédia soit par l'injonction directe des données dans le flux vidéo, ce qui reviendrait à "bruler" la vidéo avec les informations ou alors, solution plus modulable, incorporer ces informations sur un flux parallèle que nous discuterons au  \autoref{chap:HBBTV}. Le résultat final est un flux audio-visuel ne nécessitant aucun applicatif supplémentaire pour fonctionner. Il devra être directement utilisable sur une télévision, un smart-phone ou un ordinateur et permettra donc la lecture sur n'importe quel appareil.
\begin{figure}[h]
	\centering
	\includegraphics[width=1\linewidth]{fig01/Schemas_fonctionnement}
	\caption{Schémas de fonctionnement applicatif.}
	\label{fig:schemas_app}
\end{figure}



\subsection{État des lieux du marché}
\label{subsec:subsec01}

%%%%%%%%%%%%%%%% Table


\definecolor{tableHeader}{RGB}{211, 47, 47}
\definecolor{tableLineOne}{RGB}{245, 245, 245}
\definecolor{tableLineTwo}{RGB}{224, 224, 224}

\newcommand{\tableHeaderStyle}{
	\rowfont{\leavevmode\color{white}\bfseries}
	\rowcolor{tableHeader}
}




\taburowcolors[2] 2{tableLineOne .. tableLineTwo}
\tabulinesep = ^4mm_3mm
\everyrow{\tabucline[.4mm  white]{}}

\begin{longtabu} to \textwidth {l >{\bfseries}X[r, 1] X[4] l}
	\tableHeaderStyle
	& Application & Description & Difficulté \\
	
	& OpenCV & Une librairie sous licence BSD, initialement développée par Intel. C'est une librairie très puissante car elle permet notamment de traiter les vidéos, image par image. Cette api est très complète et propose presque tous les algorithmes utiles pour la "computer vision". \newline Programmation : C, C++, Python, Mathlab...
	\newline Prix : Open-source.  & Difficile \\
	
	& Wowza & Wowza est un serveur de contenu multimédia spécialisé dans la distribution de vidéos. La partie transcription est quant à elle principalement déléguée à des librairies tierces telles que FFmpeg. \newline Programmation : XML/fichier de configuration. \newline Prix : 65\$/mo (logiciel), 4500\$ (matérielle)  & Moyen \\
	
	& Wowza transcoder & Est un module de Wowza et permet la transcription des vidéos. Ce module permet aussi d'ajouter du contenu lors de la retranscription du flux. Elle utilise une librairie propriétaire propre à Wowza. \newline Programmation : Java \newline Prix : Compris par Wowza server & Difficile \\
	
	& Wowza Clamp & Est plugin RestFull propriétaire. Ce module est probablement une des solutions les plus proches de ce que l'on souhaite. Il est possible d'ajouter des overlay statiques très facilement. Désavantage : restreint à Wowza, à première vue peu maintenu. \newline Programmation : Json (RESTfull, Fichier) \newline Prix : 300\$ & Facile \\
	
	& FFmpeg \& Libav & Est le programme de référence open-source pour le transcodage. Cependant il est très limité dans l'intégration de contenu visuel. (sous-titre) Écrit en C.\newline Programmation : C++/C, Python : (Avpy, ffmpy), Autres : wrapper  & Facile à Moyen \\
	
	& Red5 & Est un serveur de distribution open-source concurrent à Wowza. Il semblerait qu'il soit moins stable que Wowza pour une utilisation professionnelle.\cite{red5-wowza} Son avantage, outre sa gratuité, est sa modularité. Il est conseillé si l'on veut faire de la programmation Java. Pas de solution d'intégration de contenu connue. \newline Programmation: Java \newline Prix : open-source  & Facile \\
	
	& Adobe Media Server & Un des pionniers dans la diffusion de contenu vidéo. Actuellement en décrudescence. Leur format a encore beaucoup d'inertie et est passablement utilisé au niveau de leurs flux de transport. La fin de flash est annoncée pour 2020.\cite{flash_dead} Pour ce qui est du serveur, celui-ci ne permet pas l'intégration de contenu type overlay sur les vidéos.   & Facile \\
	
	& Microsoft IIS Media Services & Serveur de distribution et de transcodage,; Il est limité dans l'intégration de contenu visuel. Ce serveur ne doit plus être utilisé comme solution de service multimédia. Son support s'est terminé avec Windows Server 2008 R2. Quand bien même une "extended lifetime" est prévue jusque en 2020. \cite{IIS_media} & Ne pas utiliser \\
	
	& Mist server & Serveur de distribution multimédia et de transcription (non live). Très modulaire, rapide et à empreinte CPU-Mémoire faible. Idéal si l'on ne veut pas investir dans une solution hardware car il semble plus performant que ses concurrents de type serveur web.  \newline Language : C++ (Aussi le programme en lui-même.)\newline Prix : Gratuit (OpenGL, sans DRM), Commercial : 2500\$ & Moyen \\
	
	& Video Logix & Est un boitier physique permettant de programmer les overlays directement sur un flux live. Plusieurs interfaces sont disponibles pour l'ajout des données dont des interfaces analogiques. L'avantage est un temps de latence très faible. Les désavantages sont l' encombrement physique, la nécessité de le posséder, les flux non numériques (à transcoder ). \newline Prix : 1695\$ & Moyen \\
	
	& GStreamer & Est une librairie spécialisée dans la manipulation de son et d'image. Il permet a l'origine d'afficher ou transcoder du contenu mais possède aussi quelques fonctions d'édition ainsi qu'une multitude de plugins tierces. \cite{gstream} \newline Language : C \newline Prix : Open-source & Difficile \\
	
	& GStreamer QT Overlay & Est un module basé sur Gstreamer qui permet d'ajouter des overlays en temps réel en amont du logiciel Gstreamer. Attention, certain navigateur web interdisent le site. \cite{gstream-ridgerun} \newline Prix 2500\$ & ? \\
	
\end{longtabu}
\paragraph{OpenCV} : OpenCV est une librairie open source à l'origine développée par Intel. Elle dispose de beaucoup de support de la part de la communauté ainsi que du monde universitaire; Connue notamment pour ses fonctions de machine learning. Autre avantage; Elle est disponible sur quasiment toutes les plateformes même mobiles. Voir chapitre \ref{chap:OpenCV} pour plus de détails.
\paragraph{Wowza} : 
 Streaming Engine est un serveur multimédia permettant la diffusion de contenu vidéo en streaming. Son secteur de marché est principalement la vidéo à la demande ainsi que la vidéo en temps réel.
Il dispose de plusieurs outils de retouche, conversion, compression et permet la compatibilité avec de multiples appareils. Des outils de loadbalancing géographique permettent à cet outil d'être utilisable en production à n'importe quelle échelle.
Le serveur est construit sur Java ce qui lui donne une flexibilité supplémentaire au niveau du matériel sur lequel il est déployé.
Wowza dispose d'un écosystème de plusieurs applications dans le but de cibler les clients auquels ils sont destinés. Les solutions sont notamment : [ Facebook live streamer, cloud application based on Rest API, Le serveur complet, Un cross platform SDK pour le développement mobile, Un service  CDN\footnote{content delivery network ou réseau de diffusion de contenu en français}...].
Le prix pour le serveur de contenu qui est le service le moins contraignant pour le développement se situe entre 65\$ et 95\$ pas mois. La licence à vie est de 2000\$ ce qui peut être relativement cher si le produit est utilisé de manière accessoire.
\subparagraph{Wowza Transcoder} : Connu sous le nom de `Wowza streaming engine` dans la proposition de leurs produits. C'est une api au noyau de Wowza qui nous permet de programmer son fonctionnement dont potentiellement des retouches images. Nous en discuterons plus en détails dans la partie \autoref{chap:Wowza}.
\subparagraph{Wowza Clamp} : Wowza clamp est un plugin Wowza transcoder développé par Streamingtoolbox.com. Ce plugin possède un API RESTful permettant l'ajout d'overlays. Il dispose aussi d'une interface graphique web agissant comme client REST afin d'ajouter des overlays rapidement sans programmation au préalable. Ceci permettant donc de débugger l'application et de se rendre compte du rendu des différents éléments. Une explication de l'installation est disponible dans le \autoref{chap:Wowza}. Cependant il semblerait qu'il y ait un soucis de compatibilité avec la nouvelle version de Wowza.
\paragraph{FFmpeg} 
FFmpeg est une librairie de transcodage de vidéo très connue. Beaucoup d'applications open-sources utilisent ou tout du moins se basent sur cette librairie. Comme par exemple les très connus Blender, GStreamer, Mplayer (mvp) et VLC.
Libav, fork de FFmpeg, est une librairie que l'on retrouvera souvent dans des programmes tierces ainsi que certaines distributions linux telles que la famille RHEL. VLC par exemple préférera la version Libav dans cet environnement par exemple.\cite{libav}.
Forcément, la question se pose de quid de FFmpeg ou de Libav est plus performant? En réalité, il n'y a pas de réponse tranchée à la question. Nombreux développements de qualité sont faits sur Libav et leur politique est plus sévère quant à l'intégration de code dans leur librairie. Ils privilégieront la qualité à la fonctionnalité. FFmpeg quant à eux font la course aux fonctionnalités, essayant d'avoir tous les derniers codec supportés, souvent, en lésinant sur la propreté et l'efficacité. Cependant beaucoup privilégieront ce dernier, possédant le plus de fonctionnalité. En effet toutes modifications et implémentations dans la librairie Libav sont copiées dans la librairie FFmpeg. Il y a donc peu de chance de trouver une fonction présente dans Libav et non dans FFmpeg \cite{libav_ffmpeg}.
 \paragraph{Mist server}
 Mist serveur est lui aussi un serveur de distribution et de retranscription multimédia. Il supporte passablement de codec et de transport-stream. Le serveur est très modulaire et a une empreinte faible ce qui lui permet de tourner sur les plus petits des appareils. Il est particulièrement recommandé si l'on souhaite ajouter ou modifier les fonctionnalités de celui-ci. Un avantage indéniable est qu'il peut tourner sur un Raspberry Pi contrairement à ses concurrents. Son efficacité fait sa force, sa simplicité peut être son défaut. En effet en parcourant des forums officieux, il semblerait que Wowza possède plus de fonctionnalités dans certains cas.\cite{mist}


%%%%%%%%%%%%%% End table


%=========================================================